package it.crem.server.actions;

import java.io.File;
import java.util.HashMap;
import java.util.List;

import java.util.Calendar;

import it.crem.common.Utility;
import it.crem.db.conf.GruppiFoto;
import it.crem.db.mng.DbMng;

public class FotoAction extends RoncoAction{
	private String anno = null;
	private List gruppi;
	private Integer oid = 0;
	private String[] files = null;
	private GruppiFoto gruppo = null;
	private String tipo = null;
	private String foto = "";
	
	
	public String listaGruppi(){
		DbMng db = new DbMng();
		HashMap<String,String> pars = new HashMap<String,String>();
		if ((anno!=null)&&(!"".equals(anno)))
			pars.put("anno", anno);	
		else{
			anno = Utility.getAnno(Calendar.getInstance().getTime());
			pars.put("anno", anno);
		}
		gruppi = db.getListObject("GruppiFoto", pars);
		return SUCCESS;
	}
	
	public String showAlbum(){
		DbMng db = new DbMng();
		gruppo = (GruppiFoto)db.getObject(oid, "GruppiFoto");
		File dir = new File(gruppo.getPath()+"/"+gruppo.getCartella());
		files = dir.list();
		if ((files!=null)&&(files.length>0)){
			
			for (int i=0;i<files.length;i++){
				String f = files[i];
				File cf = new File(f);
				String fn = cf.getName();
				files[i]=gruppo.getUrl()+"/"+fn;
			}
			foto = files[0];
		}
		
		return tipo;
	}
	
	
	
	public String getAnno() {
		return anno;
	}
	public void setAnno(String anno) {
		this.anno = anno;
	}
	public List getGruppi() {
		return gruppi;
	}
	public void setGruppi(List gruppi) {
		this.gruppi = gruppi;
	}

	public Integer getOid() {
		return oid;
	}

	public void setOid(Integer oid) {
		this.oid = oid;
	}

	public String[] getFiles() {
		return files;
	}

	public void setFiles(String[] files) {
		this.files = files;
	}

	public GruppiFoto getGruppo() {
		return gruppo;
	}

	public void setGruppo(GruppiFoto gruppo) {
		this.gruppo = gruppo;
	}

	public String getTipo() {
		return tipo;
	}

	public void setTipo(String tipo) {
		this.tipo = tipo;
	}

	public String getFoto() {
		return foto;
	}

	public void setFoto(String foto) {
		this.foto = foto;
	}

	
	
}
